#!/usr/bin/env fish
set stat (nordvpn status | grep Status | sed 's/.*:\ //g' | head -n1)

function confirm
  zenity --question --text=$argv[1]
  return $status
end

if [ "$stat" = "Disconnected" ]
  echo -n ""
end

if [ "$stat" = "Connecting" ]
  echo -n "..."
end

if [ "$stat" = "Connected" ]
  echo -n ""
  set ln2 (nordvpn status | grep Current\ server | sed 's/.*:\ //g')
  set server (echo $ln2 | sed  's/.//3g')
  echo -n " $server"
end

if [ "$argv" = 'toggle' ]
  if [ "$stat" = "Connected" ]
    confirm "Do you want to disconnect NordVPN?";and nordvpn d
  end
  if [ "$stat" = "Disconnected" ]
    confirm "Do you want to connect to NordVPN?";and nordvpn c
  end
end
